var difficulty,squares,rows,autoplayIntervalToDigSquare,containerHomepage=document.querySelector("#game"),boardWidth=containerHomepage.offsetWidth,boardHeight=containerHomepage.offsetHeight,screenWidth=window.innerWidth,squareSize=32,columnsToFit=Math.floor(boardWidth/squareSize),rowsToFit=Math.floor(boardHeight/squareSize),matrix=[],bombsPlaced=0,squaresInBoard=0,squaresInterractedWith=0,squaresInViewport=0,autoplayRunning=!0,userDugBombPosition="",isBombsPlacedTextVisibleToUser=!1,tellUserBombsPlacedContainer=document.querySelector(".bombs-placed-container"),tellUserBombsPlacedWrapper=document.querySelector(".bombs-placed-container .wrapper"),tellUserBombsPlaced=document.querySelector(".bombs-placed-text"),instructions=document.querySelector(".game-instructions-span"),windowWidth=window.innerWidth,flagSvg='<svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><rect x="0.666504" width="17" height="18" fill="url(#pattern0)"/><defs><pattern id="pattern0" patternContentUnits="objectBoundingBox" width="1" height="1"><use xlink:href="#image0_14_9231" transform="matrix(0.00827206 0 0 0.0078125 -0.0294118 0)"/></pattern><image id="image0_14_9231" width="128" height="128" xlink:href="data:image/png;base64,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"/></defs></svg>',mobileUserWantsToFlag=0,triggerTapFlagIcon=document.querySelector(".flag-icon-wrap"),gameSettings=document.querySelector(".gameSettings");containerHomepage.addEventListener("contextmenu",(function(e){return e.preventDefault()})),triggerTapFlagIcon.addEventListener("click",(function(){mobileUserWantsToFlag=(mobileUserWantsToFlag+1)%2}));var Square=function(){function e(e){this.isRevealed=!1,this.hasBomb=!1,this.isFlagged=!1,this.position=e,this.isWithinViewport=!0,Math.random()<difficulty&&(bombsPlaced++,this.hasBomb=!0),squaresInBoard++,squaresInViewport++}return e.prototype.digSquare=function(){var e=this;if(mobileUserWantsToFlag)return this.flagSquare(),void isGameFinished();if(!this.isRevealed){var t=this.position,o=getHtmlSquare(t[0],t[1]);if(0==this.isFlagged){if(this.isRevealed=!0,squaresInterractedWith++,this.hasBomb)o.classList.add("revealed"),o.innerHTML='<image src="/icons/bomb.svg" alt="">',setTimeout((function(){e.isRevealed=!1,e.isFlagged=!0,o.innerHTML=flagSvg,o.classList.remove("revealed")}),5e3),lostGame();else{var a=this.countSurroundingBombs();if(0==a)this.getSurroundingSquares().forEach((function(e){e.digSquare()}));else o.innerHTML=String(a),o.classList.add("B".concat(a))}o.classList.add("revealed")}else squaresInterractedWith-=1,bombsPlaced++,tellUserBombsPlaced.textContent="// ".concat(bombsPlaced),this.isFlagged=!1,o.innerHTML=""}},e.prototype.flagSquare=function(){var e=this.position,t=getHtmlSquare(e[0],e[1]);0==t.classList.contains("revealed")&&(this.isFlagged?(this.isFlagged=!1,squaresInterractedWith-=1,bombsPlaced++,t.innerHTML="",tellUserBombsPlaced.textContent="// ".concat(bombsPlaced)):(this.isFlagged=!0,squaresInterractedWith++,bombsPlaced-=1,t.innerHTML=flagSvg,tellUserBombsPlaced.textContent="// ".concat(bombsPlaced))),isGameFinished()},e.prototype.countSurroundingBombs=function(){var e=0;return this.getSurroundingSquares().forEach((function(t){t.hasBomb&&e++})),e},e.prototype.getSurroundingSquares=function(){for(var e=[],t=this.position,o=t[0],a=t[1],n=-1;n<2;n++)if(null!=matrix[Number(o)+Number(n)])for(var r=-1;r<2;r++)null!=matrix[Number(o)+Number(n)][Number(a)+Number(r)]&&(Number(o)+Number(n)==o&&Number(a)+Number(r)==a||e.push(matrix[Number(o)+Number(n)][Number(a)+Number(r)]));return e},e}();function chooseDifficulty(){var e=document.querySelector(".difficulty-feedback.active").dataset.difficulty;difficulty=[.12,.15,.2,.25][e]}function adaptGameUserInstructionsToWidth(e){void 0===e&&(e=0),instructions.innerHTML=e<1024?"// Click bottom right flag to switch to flagging or digging squares":"// Left click to dig square <br> // Right click to flag square"}function populateBoard(){matrix=[],containerHomepage.innerHTML="",squaresInBoard=0,squaresInterractedWith=0,bombsPlaced=0,autoplayRunning?difficulty=.2:chooseDifficulty(),containerHomepage.style.gridTemplateRows="repeat(".concat(rowsToFit,", minmax(24px, 1fr))");for(var e=new DocumentFragment,t=0;t<rowsToFit;t++){matrix.push([]);var o=document.createElement("div");o.classList.add("row"),o.style.gridTemplateColumns="repeat(".concat(columnsToFit,", minmax(24px, 1fr))");for(var a=0;a<columnsToFit;a++){matrix[t].push(new Square([t,a]));var n=document.createElement("div");n.classList.add("square"),n.dataset.position="".concat(t,"_").concat(a),o.appendChild(n)}e.appendChild(o)}containerHomepage.appendChild(e),rows=document.querySelectorAll(".row"),squares=document.querySelectorAll(".square")}function getHtmlSquare(e,t){return containerHomepage.childNodes[e].childNodes[t]}function autoplayGame(){var e=matrix.reduce((function(e,t){return e.concat(t)}));function t(){if(0==e.length)clearInterval(autoplayIntervalToDigSquare),populateBoard(),autoplayGame();else{var t=Math.floor(Math.random()*e.length),o=e[t],a=o.position,n=a[0],r=a[1];if(o.hasBomb)return o.isFlagged=!0,getHtmlSquare(n,r).innerHTML=flagSvg,void e.splice(t,1);o.digSquare(),e.splice(t,1),0==o.countSurroundingBombs()&&(e=e.filter((function(e){if(!e.isRevealed&&!e.isFlagged)return e})))}}autoplayRunning=!0,t(),autoplayIntervalToDigSquare=setInterval(t,1500)}function watchIfUserStartedGame(){var e=document.querySelector(".user-initiated-game-start");new MutationObserver((function(){0!=e.childElementCount?(clearInterval(autoplayIntervalToDigSquare),autoplayRunning=!1,startGame()):e.innerHTML=""})).observe(e,{childList:!0})}function startGame(){populateBoard(),isBombsPlacedTextVisibleToUser?(informUserBombsPlacedText.centerPosition(),informUserBombsPlacedText.fullOpacity(),informUserBombsPlacedText.resetFontSize(),setTimeout((function(){informUserBombsPlacedText.moveDownRightCorner(),informUserBombsPlacedText.reduceOpacity(),informUserBombsPlacedText.decreaseFontSize()}),2500),setTimeout((function(){tellUserBombsPlaced.textContent="//",setTimeout((function(){tellUserBombsPlaced.textContent="// ".concat(bombsPlaced)}),750)}),2e3)):(informUserBombsPlacedText.fadeIn(),setTimeout((function(){informUserBombsPlacedText.moveDownRightCorner(),informUserBombsPlacedText.reduceOpacity(),informUserBombsPlacedText.decreaseFontSize()}),2e3),tellUserBombsPlaced.textContent="// ".concat(bombsPlaced)),setTimeout((function(){containerHomepage.addEventListener("click",userLeftClick),containerHomepage.addEventListener("contextmenu",userRightClick)}),1500)}function userLeftClick(e){var t=e.target.dataset.position.split("_"),o=t[0],a=t[1];matrix[o][a].digSquare()}function userRightClick(e){e.preventDefault();var t=e.target.dataset.position.split("_"),o=t[0],a=t[1];matrix[o][a].flagSquare()}chooseDifficulty(),adaptGameUserInstructionsToWidth(boardWidth),populateBoard(),watchIfUserStartedGame(),autoplayGame();var panelShownPriorWindowResize,isDesktopRes,informUserBombsPlacedText=function(){function e(){}return e.reset=function(){tellUserBombsPlacedContainer.style.display="none",tellUserBombsPlacedWrapper.style.left="0px",tellUserBombsPlacedWrapper.style.top="0px",tellUserBombsPlacedWrapper.style.fontSize="3rem",tellUserBombsPlacedContainer.style.opacity="0",isBombsPlacedTextVisibleToUser=!1},e.fadeOut=function(){tellUserBombsPlacedContainer.style.opacity="0",isBombsPlacedTextVisibleToUser=!1},e.moveDownRightCorner=function(){tellUserBombsPlacedWrapper.style.left="calc(50% - 122px + 48px)",tellUserBombsPlacedWrapper.style.top="calc(50% - 40px + 68px)"},e.decreaseFontSize=function(){tellUserBombsPlacedWrapper.style.fontSize="1rem"},e.resetFontSize=function(){tellUserBombsPlacedWrapper.style.fontSize="3rem"},e.reduceOpacity=function(){tellUserBombsPlacedContainer.style.opacity="0.7"},e.fullOpacity=function(){tellUserBombsPlacedContainer.style.opacity="1"},e.centerPosition=function(){tellUserBombsPlacedWrapper.style.left="0px",tellUserBombsPlacedWrapper.style.top="0px"},e.fadeIn=function(){tellUserBombsPlacedContainer.style.display="flex",setTimeout((function(){tellUserBombsPlacedContainer.style.opacity="1"}),100),isBombsPlacedTextVisibleToUser=!0},e}();function lostGame(){var e=document.querySelector(".end-game-status"),t=document.querySelector(".start-game-button"),o=Math.ceil(2*Math.random()),a=Math.ceil(2*Math.random()),n=document.querySelector(".textContent"),r=document.querySelector(".gameSettings"),i=0,s=!1,l=document.querySelector(".dead-smiley-wrapper"),c=document.querySelector(".footer-links-container"),u=document.querySelector(".socials-icon-wrap"),d=document.querySelector(".flag-icon-wrap");(c.classList.toggle("hide-icons"),u.classList.toggle("show"),d.classList.toggle("show"),l.style.display="flex",autoplayRunning=!0,autoplayGame(),containerHomepage.removeEventListener("click",userLeftClick),containerHomepage.removeEventListener("contextmenu",userRightClick),screenWidth>=1023?setTimeout((function(){autoplayRunning&&(informUserBombsPlacedText.fadeOut(),setTimeout((function(){informUserBombsPlacedText.reset()}),1500))}),4500):informUserBombsPlacedText.reset(),screenWidth<=1023)?(document.querySelector(".show-settings-panel-button").innerHTML="You-lost<br>Play-again?",n.style.display="flex",setTimeout((function(){n.style.opacity="1"}))):(e.innerHTML="You've lost the game",t.innerHTML="Play-again",n.style.display="flex",r.style.display="flex",setTimeout((function(){n.style.opacity="1",r.style.opacity="1"}),50));setTimeout((function(){if(autoplayRunning){var e=Number(userDugBombPosition.split("_")[0]),t=Number(userDugBombPosition.split("_")[1]);matrix[e][t].isRevealed=!1,matrix[e][t].isFlagged=!0,getHtmlSquare(e,t).innerHTML=flagSvg,getHtmlSquare(e,t).classList.remove("revealed"),squaresInterractedWith++}}),5e3),containerHomepage.style.scale="1.01",containerHomepage.style.left="".concat(o,"px"),containerHomepage.style.top="".concat(a,"px");var m=setInterval((function(){9==i&&clearInterval(m),s?(s=!1,containerHomepage.style.left="-".concat(o,"px"),containerHomepage.style.top="-".concat(a,"px")):(s=!0,containerHomepage.style.left="".concat(o,"px"),containerHomepage.style.top="".concat(a,"px")),i++}),30)}function isGameFinished(){squaresInViewport===squaresInterractedWith&&(autoplayRunning?populateBoard():winGame())}function winGame(){var e=document.querySelector(".end-game-status"),t=document.querySelector(".start-game-button"),o=document.querySelector(".textContent"),a=document.querySelector(".gameSettings"),n=document.querySelector(".footer-links-containerHomepage"),r=document.querySelector(".socials-icon-wrap"),i=document.querySelector(".flag-icon-wrap");(n.classList.toggle("hide-icons"),r.classList.toggle("show"),i.classList.toggle("show"),setTimeout((function(){populateBoard(),autoplayGame(),autoplayRunning=!0}),3e4),screenWidth>860?setTimeout((function(){autoplayRunning&&(informUserBombsPlacedText.fadeOut(),setTimeout((function(){informUserBombsPlacedText.reset()}),1500))}),4500):informUserBombsPlacedText.reset(),containerHomepage.removeEventListener("click",userLeftClick),containerHomepage.removeEventListener("contextmenu",userRightClick),screenWidth<720)?(document.querySelector(".show-settings-panel-button").innerHTML="You-won<br>Play-again?",o.style.display="flex",setTimeout((function(){o.style.opacity="1"}),50)):(e.innerHTML="You've won!",t.innerHTML="Play-again",o.style.display="flex",a.style.display="flex",setTimeout((function(){o.style.opacity="1",a.style.opacity="1"}),50))}function storeLastMobilePanelState(e){var t=document.querySelector(".textContent");if(e<1024){if(document.querySelector(".end-game-status").innerHTML="",null==isDesktopRes&&(isDesktopRes=!1),isDesktopRes){if(!autoplayRunning)return;"textContent"==panelShownPriorWindowResize&&(gameSettings.style.opacity="0",gameSettings.style.display="none",t.style.opacity="1",t.style.display="flex"),"gameSettings"==panelShownPriorWindowResize&&(gameSettings.style.opacity="1",gameSettings.style.display="flex",t.style.opacity="0",t.style.display="none"),isDesktopRes=!1}}else if(null==isDesktopRes&&(isDesktopRes=!0),""==t.style.display&&(t.style.display="flex"),0==isDesktopRes){if(!autoplayRunning)return;panelShownPriorWindowResize="flex"==t.style.display?"textContent":"gameSettings",t.style.opacity="1",t.style.display="flex",gameSettings.style.opacity="1",gameSettings.style.display="flex",isDesktopRes=!0}}function updateOldSiblingSquaresNearNewlyAddedSquares(e){var t=e.dataset.position.split("_"),o=t[0],a=t[1],n=e.textContent,r="B"+n,i=matrix[o][a].countSurroundingBombs();if(""==n){if(0===i)return;return e.innerHTML=i,void e.classList.add("B".concat(i))}e.innerHTML=i,e.classList.replace(r,"B".concat(i))}function watchIfUserSwitchesPage(){var e=document.querySelector(".is-minesweeper-playing-in-homepage");new MutationObserver((function(){0==e.childElementCount?(clearInterval(autoplayIntervalToDigSquare),matrix=[],squaresInBoard=0,squaresInterractedWith=0,bombsPlaced=0,boardWidth=0,boardHeight=0,screenWidth=0,columnsToFit=0,rowsToFit=0,matrix=[],squaresInBoard=0,squaresInterractedWith=0,squaresInViewport=0,autoplayRunning=!1,userDugBombPosition="",isBombsPlacedTextVisibleToUser=!1,mobileUserWantsToFlag=0):setTimeout((function(){containerHomepage=document.querySelector("#game"),boardWidth=containerHomepage.offsetWidth,boardHeight=containerHomepage.offsetHeight,screenWidth=window.innerWidth,columnsToFit=Math.floor(boardWidth/squareSize),rowsToFit=Math.floor(boardHeight/squareSize),tellUserBombsPlacedContainer=document.querySelector(".bombs-placed-container"),tellUserBombsPlacedWrapper=document.querySelector(".bombs-placed-container .wrapper"),tellUserBombsPlaced=document.querySelector(".bombs-placed-text"),triggerTapFlagIcon=document.querySelector(".flag-icon-wrap"),gameSettings=document.querySelector(".gameSettings"),autoplayRunning=!0,watchIfUserStartedGame(),populateBoard(),autoplayGame()}),150)})).observe(e,{childList:!0})}window.addEventListener("resize",(function(){var e=containerHomepage.offsetWidth,t=containerHomepage.offsetHeight,o=Math.floor(e/squareSize),a=Math.floor(t/squareSize),n=o-columnsToFit,r=a-rowsToFit;adaptGameUserInstructionsToWidth(screenWidth=window.innerWidth),storeLastMobilePanelState(screenWidth),o>columnsToFit&&function(){clearInterval(autoplayIntervalToDigSquare);var t=[];rows.forEach((function(e,a){e.lastChild.classList.contains("revealed")&&t.push(e.lastChild);for(var r=matrix[a].length,i=0;i<n;i++){var s=document.createElement("div");s.classList.add("square"),s.dataset.position="".concat(a,"_").concat(r+i),matrix[a].push(new Square([a,r+i])),e.appendChild(s)}e.style.gridTemplateColumns="repeat(".concat(o,", minmax(24px, 1fr))")})),t.forEach((function(e){updateOldSiblingSquaresNearNewlyAddedSquares(e)})),columnsToFit=o,boardWidth=e,squares=document.querySelectorAll(".square"),tellUserBombsPlaced.textContent="// ".concat(bombsPlaced),autoplayRunning&&autoplayGame()}(),a>rowsToFit&&function(){clearInterval(autoplayIntervalToDigSquare);for(var e=new DocumentFragment,o=0;o<r;o++){var n=document.createElement("div");n.classList.add("row"),n.style.gridTemplateColumns="repeat(".concat(columnsToFit,", minmax(24px, 1fr))"),matrix.push([]);for(var i=0;i<columnsToFit;i++){matrix[matrix.length-1].push(new Square([matrix.length-1,i]));var s=document.createElement("square");s.classList.add("square"),s.dataset.position="".concat(matrix.length-1,"_").concat(i),n.appendChild(s)}e.append(n)}containerHomepage.lastChild.previousSibling.childNodes.forEach((function(e){e.classList.contains("revealed")&&""!=e.textContent&&updateOldSiblingSquaresNearNewlyAddedSquares(e)})),containerHomepage.style.gridTemplateRows="repeat(".concat(a,", minmax(24px, 1fr))"),rowsToFit=a,boardHeight=t,rows=document.querySelectorAll(".row"),tellUserBombsPlaced.textContent="// ".concat(bombsPlaced),autoplayRunning&&autoplayGame()}()})),watchIfUserSwitchesPage();